---
import type { Testimonial } from '@/lib/schemas';
import { Image } from 'astro:assets';

interface Props {
  id?: string;
  testimonials: Testimonial[];
}

const { id, testimonials } = Astro.props;
---

<section id={id} class="section bg-depths/30">
  <div class="container">
    <!-- Section Header -->
    <div class="text-center mb-16 space-y-4">
      <p class="text-terminal text-cyan-glow text-sm uppercase tracking-wider">
        <span class="text-text-muted">//</span> Social Proof
      </p>
      <h2 class="text-4xl md:text-5xl font-bold text-text-primary">
        Testimonials
      </h2>
      <p class="text-text-secondary max-w-2xl mx-auto">
        Direct recommendations from colleagues, managers, and clients on LinkedIn.
      </p>
    </div>
    
    <!-- Masonry Grid -->
    {testimonials.length > 0 ? (
      <div class="masonry-grid">
        {testimonials.map((testimonial) => (
          <figure class="masonry-item card card-cyber p-0 overflow-hidden group">
            {/* Screenshot Image */}
            <div class="relative">
              <img
                src={testimonial.screenshot}
                alt={`LinkedIn recommendation from ${testimonial.authorName} - ${testimonial.textContent.slice(0, 100)}...`}
                class="w-full h-auto"
                loading="lazy"
                decoding="async"
              />
              {/* Hover Overlay */}
              <div class="absolute inset-0 bg-gradient-to-t from-abyss/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <div class="absolute bottom-0 left-0 right-0 p-4">
                  <a 
                    href="https://linkedin.com/in/shreyans-bhatt" 
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center gap-2 text-sm text-cyan-glow hover:text-cyan-dim transition-colors"
                  >
                    <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    View on LinkedIn
                  </a>
                </div>
              </div>
            </div>
            
            {/* Caption */}
            <figcaption class="p-4 border-t border-surface">
              <div class="flex items-start gap-3">
                <div class="w-10 h-10 rounded-full bg-cyan-glow/20 flex items-center justify-center shrink-0">
                  <span class="text-cyan-glow font-semibold text-sm">
                    {testimonial.authorName.split(' ').map(n => n[0]).join('').slice(0, 2)}
                  </span>
                </div>
                <div class="min-w-0">
                  <p class="font-semibold text-text-primary truncate">{testimonial.authorName}</p>
                  <p class="text-sm text-text-secondary truncate">{testimonial.authorRole}</p>
                  <p class="text-xs text-text-muted">{testimonial.authorCompany}</p>
                </div>
              </div>
              
              {/* Date */}
              <p class="mt-3 text-xs text-text-muted">
                {new Date(testimonial.date).toLocaleDateString('en-US', { 
                  year: 'numeric', 
                  month: 'long' 
                })}
              </p>
            </figcaption>
          </figure>
        ))}
      </div>
    ) : (
      <!-- Empty State -->
      <div class="text-center py-16">
        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-depths flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-text-muted" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
          </svg>
        </div>
        <p class="text-text-secondary">No testimonials yet. Check back soon!</p>
      </div>
    )}
    
    <!-- CTA -->
    <div class="mt-16 text-center">
      <a 
        href="https://www.linkedin.com/in/shreyans-bhatt"
        target="_blank"
        rel="noopener noreferrer"
        class="btn btn-outline"
      >
        <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
        </svg>
        View All on LinkedIn
      </a>
    </div>
  </div>
</section>
